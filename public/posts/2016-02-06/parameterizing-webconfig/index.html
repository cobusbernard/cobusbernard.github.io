<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    










    







<script defer language="javascript" type="text/javascript" src="/js/bundle.min.cbcd24d8731b2aea4f1fef1db2519a78fa4d97baf0a2241b1d0b9759cb5d5acc.js"></script>






    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="icon" href=/favicon.png>

    
    





  





  
  
  


<!-- Open Graph image and Twitter Card metadata -->

<title itemprop="name">Cobus - Parameterizing Web.config</title>
<meta property="og:title" content=Cobus&#32;-&#32;Parameterizing&#32;Web.config />
<meta name="twitter:title" content=Cobus&#32;-&#32;Parameterizing&#32;Web.config />
<meta itemprop="name" content=Cobus&#32;-&#32;Parameterizing&#32;Web.config />
<meta name="application-name" content=Cobus&#32;-&#32;Parameterizing&#32;Web.config />
<meta property="og:site_name" content="" />


<meta name="description" content="How to change the values of web.config at deploy time without configuration profiles." />
<meta itemprop="description" content="How to change the values of web.config at deploy time without configuration profiles." />
<meta property="og:description" content="How to change the values of web.config at deploy time without configuration profiles." />
<meta name="twitter:description" content="How to change the values of web.config at deploy time without configuration profiles." />


<base href="//localhost:1313/posts/2016-02-06/parameterizing-webconfig/" />
<link rel="canonical" href="//localhost:1313/posts/2016-02-06/parameterizing-webconfig/" itemprop="url" />
<meta name="url" content="//localhost:1313/posts/2016-02-06/parameterizing-webconfig/" />
<meta name="twitter:url" content="//localhost:1313/posts/2016-02-06/parameterizing-webconfig/" />
<meta property="og:url" content="//localhost:1313/posts/2016-02-06/parameterizing-webconfig/" />


<meta property="og:updated_time" content="2016-02-06T00:00:00Z" />


<link rel="sitemap" type="application/xml" title="Sitemap" href='//localhost:1313/sitemap.xml' />

<meta name="robots" content="index,follow" />
<meta name="googlebot" content="index,follow" />


<meta name="twitter:site" content="https://twitter.com/cobusbernard" />
<meta name="twitter:creator" content="https://twitter.com/cobusbernard" />
<meta property="fb:admins" content="" />


<meta name="apple-mobile-web-app-title" content="" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />






<meta name="generator" content="Hugo 0.126.1">


    
    

<link type="text/css" rel="stylesheet" href="/css/bundle.min.94a339836f89f0d25f31980cb6b0631da21e20af128308747ce44e0525eb16ef.css">


    
    <style>
    body {
        --sidebar-bg-color: #202020;
        --sidebar-img-border-color: #515151;
        --sidebar-p-color: #909090;
        --sidebar-h1-color: #FFF;
        --sidebar-a-color: #FFF;
        --sidebar-socials-color: #FFF;
        --text-color: #222;
        --bkg-color: #FAF9F6;
        --post-title-color: #303030;
        --list-color: #5A5A5A;
        --link-color: #268BD2;
        --date-color: #515151;
        --table-border-color: #E5E5E5;
        --table-stripe-color: #F9F9F9;
        --code-color: #000;
        --code-background-color: #E5E5E5;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
        --moon-sun-color: #FFF;
        --moon-sun-background-color: #515151;
    }
    body.dark-theme {
        --text-color: #EEE;
        --bkg-color: #121212;
        --post-title-color: #DBE2E9;
        --list-color: #9D9D9D;
        --link-color: #268BD2;
        --date-color: #9A9A9A;
        --table-border-color: #515151;
        --table-stripe-color: #202020;
        --code-color: #FFF;
        --code-background-color: #515151;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
    }
    body {
        background-color: var(--bkg-color);
    }
</style>

</head>

    <body class="dark-theme">
        <div class="wrapper">
            <aside class="sidebar">
    <div class="container sidebar-sticky">
        
        <div class="sidebar-about">
    <h1 class="brand">
        
            <a href="//localhost:1313/">
                <img src="/images/author/cobus_8_bit.png" alt="brand image">
            </a>
        
        
            <a href="//localhost:1313/">
                <h1>Cobus</h1>
            </a>
        
    </h1>
    <p class="lead">
    (thoughts) => TryParse(thoughts, out blog)
    </p>
</div>

        <nav>
    <ul class="sidebar-nav">

        
        
        
        
            

            
                
                
                    <li class="heading">
                        <a href="/about/">About</a>
                    </li>
                    
                
            
                
                
            
            
                
                
                        
                
                        
                
            
                
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
                    <li class="heading">
                        <a href="/posts/">Posts</a>
                    </li>
                    
                        <li class="sub-heading">
                            Recent
                        </li>
                        
                            <li class="bullet">
                                <a href="//localhost:1313/posts/2024-05-28/migrating-jekyll-to-hugo/">Migrating my Jekyll blog to Hugo with Gen-AI</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="//localhost:1313/posts/2017-02-09/osx-home-end-keys/">Remapping the Home and End keys on OSX</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="//localhost:1313/posts/2017-02-05/yak-shaving-makefiles/">Yak Shaving - Makefiles</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="//localhost:1313/posts/2017-01-15/timemachine-backups/">Setting up a Timemachine server using Mesos/Marathon</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="//localhost:1313/posts/2016-09-03/aws-multi-account/">Securing AWS environments using role switching</a>
                            </li>
                        
                    
                
            
            
                
                
                        
                
                        
                
            
                
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        

    </ul>
</nav>

        
    <a target="_blank" class="social" title="GitHub" href="https://github.com/cobusbernard">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24">
            <path fill="currentColor" d="M18.88 1.099C18.147.366 17.265 0 16.233 0H3.746C2.714 0 1.832.366 1.099 1.099C.366 1.832 0 2.714 0 3.746v12.487c0 1.032.366 1.914 1.099 2.647c.733.733 1.615 1.099 2.647 1.099H6.66c.19 0 .333-.007.429-.02a.504.504 0 0 0 .286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555 0 0 1-.904-.091a2.026 2.026 0 0 1-.872-.39a1.651 1.651 0 0 1-.572-.8l-.13-.3a3.25 3.25 0 0 0-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956 0 0 1-.17-.156a.723.723 0 0 1-.117-.182c-.026-.061-.004-.111.065-.15c.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1 0 0 1 .631.677c.2.355.44.626.722.813c.282.186.566.28.852.28c.286 0 .533-.022.742-.065a2.59 2.59 0 0 0 .585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907 0 0 1-1.333-.234a5.314 5.314 0 0 1-1.223-.507a3.5 3.5 0 0 1-1.047-.872c-.277-.347-.505-.802-.683-1.365c-.177-.564-.266-1.215-.266-1.952c0-1.049.342-1.942 1.027-2.68c-.32-.788-.29-1.673.091-2.652c.252-.079.625-.02 1.119.175c.494.195.856.362 1.086.5c.23.14.414.257.553.352a9.233 9.233 0 0 1 2.497-.338c.859 0 1.691.113 2.498.338l.494-.312a6.997 6.997 0 0 1 1.197-.572c.46-.174.81-.221 1.054-.143c.39.98.424 1.864.103 2.653c.685.737 1.028 1.63 1.028 2.68c0 .737-.089 1.39-.267 1.957c-.177.568-.407 1.023-.689 1.366a3.65 3.65 0 0 1-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9 0 0 1-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36 0 0 0 .208.189c.096.034.18.056.254.064c.074.01.18.013.318.013h2.914c1.032 0 1.914-.366 2.647-1.099c.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/>
        </svg>
    </a>



    <a target="_blank" class="social" title="LinkedIn" href="https://linkedin.com/in/cobusbernard">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 448 512">
            <path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5c0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7c-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5c67.2 0 79.7 44.3 79.7 101.9V416z"/>
        </svg>
    </a>


    <a target="_blank" class="social" title="Twitter" href="https://twitter.com/cobusbernard">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M5.032 14.286c6.037 0 9.34-4.837 9.34-9.032c0-.137 0-.274-.01-.41A6.56 6.56 0 0 0 16 3.2c-.6.256-1.235.425-1.885.5a3.207 3.207 0 0 0 1.443-1.757c-.645.37-1.35.63-2.085.77a3.322 3.322 0 0 0-1.862-.958a3.384 3.384 0 0 0-2.082.334a3.223 3.223 0 0 0-1.442 1.49a3.08 3.08 0 0 0-.208 2.03a9.57 9.57 0 0 1-3.747-.963a9.269 9.269 0 0 1-3.018-2.354a3.086 3.086 0 0 0-.36 2.314c.189.787.68 1.475 1.376 1.924a3.344 3.344 0 0 1-1.49-.398v.04c0 .734.263 1.444.743 2.01a3.3 3.3 0 0 0 1.89 1.102c-.483.128-.99.146-1.482.055a3.19 3.19 0 0 0 1.168 1.577a3.36 3.36 0 0 0 1.9.627A6.732 6.732 0 0 1 0 12.86a9.527 9.527 0 0 0 5.032 1.423"/>
        </svg>
    </a>


    <a target="_blank" class="social" rel="me" title="Mastodon" href="https://hachyderm.io/@cobusbernard">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 24 24">
            <path fill="currentColor" d="M20.94 14c-.28 1.41-2.44 2.96-4.97 3.26c-1.31.15-2.6.3-3.97.24c-2.25-.11-4-.54-4-.54v.62c.32 2.22 2.22 2.35 4.03 2.42c1.82.05 3.44-.46 3.44-.46l.08 1.65s-1.28.68-3.55.81c-1.25.07-2.81-.03-4.62-.5c-3.92-1.05-4.6-5.24-4.7-9.5l-.01-3.43c0-4.34 2.83-5.61 2.83-5.61C6.95 2.3 9.41 2 11.97 2h.06c2.56 0 5.02.3 6.47.96c0 0 2.83 1.27 2.83 5.61c0 0 .04 3.21-.39 5.43M18 8.91c0-1.08-.3-1.91-.85-2.56c-.56-.63-1.3-.96-2.23-.96c-1.06 0-1.87.41-2.42 1.23l-.5.88l-.5-.88c-.56-.82-1.36-1.23-2.43-1.23c-.92 0-1.66.33-2.23.96C6.29 7 6 7.83 6 8.91v5.26h2.1V9.06c0-1.06.45-1.62 1.36-1.62c1 0 1.5.65 1.5 1.93v2.79h2.07V9.37c0-1.28.5-1.93 1.51-1.93c.9 0 1.35.56 1.35 1.62v5.11H18V8.91Z"/>
        </svg>
    </a>



    <a target="_blank" class="social" title="Discord" href="https://discord.gg/w6BhuzNX">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 24 24">
            <path fill="currentColor" d="M19.27 5.33C17.94 4.71 16.5 4.26 15 4a.09.09 0 0 0-.07.03c-.18.33-.39.76-.53 1.09a16.09 16.09 0 0 0-4.8 0c-.14-.34-.35-.76-.54-1.09c-.01-.02-.04-.03-.07-.03c-1.5.26-2.93.71-4.27 1.33c-.01 0-.02.01-.03.02c-2.72 4.07-3.47 8.03-3.1 11.95c0 .02.01.04.03.05c1.8 1.32 3.53 2.12 5.24 2.65c.03.01.06 0 .07-.02c.4-.55.76-1.13 1.07-1.74c.02-.04 0-.08-.04-.09c-.57-.22-1.11-.48-1.64-.78c-.04-.02-.04-.08-.01-.11c.11-.08.22-.17.33-.25c.02-.02.05-.02.07-.01c3.44 1.57 7.15 1.57 10.55 0c.02-.01.05-.01.07.01c.11.09.22.17.33.26c.04.03.04.09-.01.11c-.52.31-1.07.56-1.64.78c-.04.01-.05.06-.04.09c.32.61.68 1.19 1.07 1.74c.03.01.06.02.09.01c1.72-.53 3.45-1.33 5.25-2.65c.02-.01.03-.03.03-.05c.44-4.53-.73-8.46-3.1-11.95c-.01-.01-.02-.02-.04-.02zM8.52 14.91c-1.03 0-1.89-.95-1.89-2.12s.84-2.12 1.89-2.12c1.06 0 1.9.96 1.89 2.12c0 1.17-.84 2.12-1.89 2.12zm6.97 0c-1.03 0-1.89-.95-1.89-2.12s.84-2.12 1.89-2.12c1.06 0 1.9.96 1.89 2.12c0 1.17-.83 2.12-1.89 2.12z"/>
        </svg>
    </a>


    <a target="_blank" class="social" title="YouTube" href="https://youtube.com/@cobusbernard">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 24 24">
            <path fill="currentColor" d="M12.006 19.012h-.02c-.062 0-6.265-.012-7.83-.437a2.5 2.5 0 0 1-1.764-1.765A26.494 26.494 0 0 1 1.986 12a26.646 26.646 0 0 1 .417-4.817A2.564 2.564 0 0 1 4.169 5.4c1.522-.4 7.554-.4 7.81-.4H12c.063 0 6.282.012 7.831.437c.859.233 1.53.904 1.762 1.763c.29 1.594.427 3.211.407 4.831a26.568 26.568 0 0 1-.418 4.811a2.51 2.51 0 0 1-1.767 1.763c-1.52.403-7.553.407-7.809.407Zm-2-10.007l-.005 6l5.212-3l-5.207-3Z"/>
        </svg>
    </a>


    <a target="_blank" class="social" title="Instagram" href="https://instagram.com">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 448 512">
            <path fill="currentColor" d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9S287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7s74.7 33.5 74.7 74.7s-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8c-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8s26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9c-26.2-26.2-58-34.4-93.9-36.2c-37-2.1-147.9-2.1-184.9 0c-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9c1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0c35.9-1.7 67.7-9.9 93.9-36.2c26.2-26.2 34.4-58 36.2-93.9c2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6c-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6c-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6c29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6c11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/>
        </svg>
    </a>







    <a target="_blank" class="social" title="RSS Feed" href="/posts/index.xml">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 1280.000000 1280.000000">
            <g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="currentColor">
                <path d="M2295 11929 c-284 -12 -642 -45 -707 -65 -17 -5 -18 -63 -18 -1039 0 -569 4 -1036 8 -1039 5 -3 74 6 153 19 510 86 1168 95 1789 25 1348 -153 2602 -677 3670 -1531 385 -308 820 -744 1126 -1129 842 -1060 1362 -2313 1514 -3650 70 -621 61 -1279 -25 -1789 -13 -79 -22 -148 -19 -153 3 -4 471 -8 1039 -8 l1035 0 5 23 c51 225 85 942 67 1419 -23 605 -77 1044 -198 1617 -294 1400 -927 2734 -1823 3846 -1043 1295 -2364 2259 -3909 2854 -1158 447 -2451 656 -3707 600z"/>
                <path d="M2255 7845 c-269 -25 -620 -81 -667 -106 -17 -9 -18 -55 -18 -899 0 -706 3 -890 13 -890 6 0 66 18 132 41 130 44 288 79 467 105 154 21 577 30 749 15 1207 -107 2267 -823 2814 -1902 166 -327 268 -637 330 -1001 38 -227 48 -384 42 -662 -8 -348 -44 -590 -126 -831 -23 -66 -41 -126 -41 -132 0 -10 184 -13 890 -13 844 0 890 1 899 18 27 50 88 452 110 725 14 162 14 624 1 782 -59 703 -233 1323 -545 1945 -481 956 -1313 1788 -2270 2268 -620 310 -1239 483 -1940 542 -165 14 -669 10 -840 -5z"/>
                <path d="M2519 3815 c-391 -66 -725 -336 -868 -703 -79 -201 -96 -462 -45 -677 83 -344 338 -641 666 -774 116 -47 205 -69 330 -80 412 -39 811 153 1040 500 193 292 240 648 128 981 -135 403 -492 699 -914 757 -100 14 -241 12 -337 -4z"/>
            </g>
        </svg>
    </a>



        <p class="footnote">
powered by <a target="_blank" href="https://gohugo.io">Hugo</a> | themed with <a target="_blank" href="https://github.com/lukeorth/poison">poison</a>
    <br>
    &copy; 2024 . All rights reserved.
</p>

  </div>
</aside>

            <main class="content container">
                <div class="post">
  <div class="info">
  <h1 class="post-title">
    <a href="//localhost:1313/posts/2016-02-06/parameterizing-webconfig/">Parameterizing Web.config</a>
  </h1>

  <div class="headline">
    <div>
      
      <time datetime=" 2016-02-06T00:00:00Z" class="post-date">
        February 6, 2016
      </time>
      
      <span> - </span>
      <span class="reading-time">
        
          
        

        <span>6 mins read</span>
      </span>
    </div>

    
    <ul class="tags">
      
      <li class="tag-windows">
        <a href="//localhost:1313/tags/windows">windows</a>
      </li>
      
      <li class="tag-webapi">
        <a href="//localhost:1313/tags/webapi">webapi</a>
      </li>
      
      <li class="tag-builds">
        <a href="//localhost:1313/tags/builds">builds</a>
      </li>
      
    </ul>
    
  </div>

  
  

  
</div>

  <p>Most people would have experienced the issue of setting values in <code>web.config</code> for a project on different environments, i.e. the connection string for the database. My first attempt at resolving this was to simply create multiple configurations and build the appropriate one per environment. This has multiple issues: you are including sensitive information in your build artifact, creating different builds for the same version (to allow different values) and tightly coupling your build process to your environment values. This will require a rebuild if your connection string changes, which could be problematic if you are unable to build a specific version easily. But it won&rsquo;t be the exact same version as you would need to commit the new config value, re-tag and finally rebuild the solution. Sounds like too much effort for a simple change.</p>
<h2 id="creating-a-project-to-test-this">Creating a project to test this</h2>
<p>First, let&rsquo;s create a new solution to work with. Create project -&gt; Web -&gt; ASP.Net Web Application</p>
<p><img src="./images/web_api_create_project.png" alt="Create Project"></p>
<p><img src="./images/web_api_create_project_options.png" alt="Create Project Options"></p>
<p><img src="./images/web_api_create_project_authentication.png" alt="Create Project Authentication"></p>
<p>Save the project and close it. Your folder should look like this:</p>
<p><img src="./images/web_api_default_structure.png" alt="Default Project Structure"></p>
<p>You often have additional files to store in your version control system, so I prefer to keep all my source in a sub-folder called <code>src</code>. Move the files into the directory and you should have a folder structure like this:</p>
<p><img src="./images/web_api_new_structure.png" alt="Suggested Project Structure"></p>
<h2 id="adding-the-parametersxml-file">Adding the parameters.xml file</h2>
<p>There is feature that isn&rsquo;t very well known: you can set parameters in the <code>web.config</code> at deployment time via a <code>SetParameters.xml</code> file if you are creating your build artifact via <a href="https://msdn.microsoft.com/en-us/library/wea2sca5%28v=vs.90%29.aspx" target="_blank">MSBuild</a>. If you want to add additional parameters into it, add <code>parameters.xml</code> to the project you are publishing.</p>
<p><img src="./images/web_api_add_parameters.png" alt="Adding parameters.xml"></p>
<p>Now add the following content to it:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;parameters&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;parameter</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;IIS Web Application Name&#34;</span> <span style="color:#a6e22e">defaultValue=</span><span style="color:#e6db74">&#34;Default Web Site/WebApi.Template&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;parameter</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;NHibernate Connection string&#34;</span> <span style="color:#a6e22e">defaultValue=</span><span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;parameterEntry</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">kind=</span><span style="color:#e6db74">&#34;XmlFile&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">scope=</span><span style="color:#e6db74">&#34;Website\\Web\.config$&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">match=</span><span style="color:#e6db74">&#34;/configuration/connectionStrings/add[@name=&#39;NHibernateConnection&#39;]/@connectionString&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/parameter&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;parameter</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;LOGENTRIES_TOKEN&#34;</span> <span style="color:#a6e22e">defaultValue=</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;parameterEntry</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">kind=</span><span style="color:#e6db74">&#34;XmlFile&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">scope=</span><span style="color:#e6db74">&#34;Website\\Web\.config$&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">match=</span><span style="color:#e6db74">&#34;/configuration/appSettings/add[@key=&#39;LOGENTRIES_TOKEN&#39;]/@value&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/parameter&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/parameters&gt;</span>
</span></span></code></pre></div><p>The important parts to note here are:</p>
<ul>
<li><code>name=&quot;&lt;parameter name&gt;&quot;</code> - Allows giving the parameter a human readable name, i.e. <code>NHibnernation Connection string</code></li>
<li><code>defaultValue=&quot;&quot;</code> - you can specify a default value to use if there is none in the <code>SetParameters.xml</code> file for it, i.e. <code>INFO</code> as the log level if not specified. Leaving it empty will enforce adding a value to the <code>SetParameters.xml</code> file.</li>
<li><code>scope=&quot;Website\\Web\.config$&quot;</code> - Specifies the file to search using the <code>match</code> string. The default packaging does not put the files in this folder structure, more on that further down.</li>
<li><code>match=&quot;/configuration/connectionStrings/add[@name='NHibernateConnection']/@connectionString&quot; /&gt;</code> - The location of the value to set using the value we provide. Once again, more on this further down.</li>
</ul>
<h2 id="creating-a-publishing-profile">Creating a publishing profile</h2>
<p>This will allow you to add additional parameters to <code>SetParameters.xml</code>. To test what this does, we can use the publish feather in Visual Studio to publish to a local file. Create a publishing profile by right-clicking on the <code>WebApi.Template</code> project and selecting <code>Publish</code> and click on <code>Custom</code>. Use the following values which are relative to your project file. This is where the folder structure starts to help, we will be creating a <code>dist</code> folder next to the <code>src</code> one to which we will publish the project. Once we add the solution to source control, we can exclude the <code>dist</code> folder to avoid committing compiled code.</p>
<p><img src="./images/web_api_create_local_publish_profile.png" alt="Publish Profile Create"></p>
<p><img src="./images/web_api_publish_profile_location.png" alt="Publish Profile Connection"></p>
<p><img src="./images/web_api_publish_profile_settings.png" alt="Publish Profile Settings"></p>
<p><img src="./images/web_api_publish_profile_preview.png" alt="Publish Profile Preview"></p>
<p>After clicking finish, you will should see the following in the build output at the bottom of Visual Studio:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#ae81ff">1</span>&gt;------ Build started<span style="color:#960050;background-color:#1e0010">:</span> Project<span style="color:#960050;background-color:#1e0010">:</span> WebApi.Template, Configuration<span style="color:#960050;background-color:#1e0010">:</span> Release Any CPU ------
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>&gt;  WebApi.Template -&gt; V:\Personal\WebApi.Template\src\WebApi.Template\bin\WebApi.Template.dll
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;------ Publish started<span style="color:#960050;background-color:#1e0010">:</span> Project<span style="color:#960050;background-color:#1e0010">:</span> WebApi.Template, Configuration<span style="color:#960050;background-color:#1e0010">:</span> Release Any CPU ------
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;Transformed Web.config using V:\Personal\WebApi.Template\src\WebApi.Template\Web.Release.config into obj\Release\TransformWebConfig\transformed\Web.config.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;Auto ConnectionString Transformed Areas\HelpPage\Views\Web.config into obj\Release\CSAutoParameterize\transformed\Areas\HelpPage\Views\Web.config.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;Auto ConnectionString Transformed Views\Web.config into obj\Release\CSAutoParameterize\transformed\Views\Web.config.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;Auto ConnectionString Transformed obj\Release\TransformWebConfig\transformed\Web.config into obj\Release\CSAutoParameterize\transformed\Web.config.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;Copying all files to temporary location below <span style="color:#66d9ef">for</span> package/publish<span style="color:#960050;background-color:#1e0010">:</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;obj\Release\Package\PackageTmp.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;Packaging into V:\Personal\WebApi.Template\src\dist\WebApi.Template.zip.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;Adding sitemanifest (sitemanifest).
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;Adding IIS Application (V:\Personal\WebApi.Template\src\WebApi.Template\obj\Release\Package\PackageTmp)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;Creating application (V:\Personal\WebApi.Template\src\WebApi.Template\obj\Release\Package\PackageTmp)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;Adding virtual path (V:\Personal\WebApi.Template\src\WebApi.Template\obj\Release\Package\PackageTmp)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;Adding directory (V:\Personal\WebApi.Template\src\WebApi.Template\obj\Release\Package\PackageTmp).
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;Adding file (V:\Personal\WebApi.Template\src\WebApi.Template\obj\Release\Package\PackageTmp\Web.config).
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;Adding ACL<span style="color:#e6db74">&#39;s for path (V:\Personal\WebApi.Template\src\WebApi.Template\obj\Release\Package\PackageTmp)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">2&gt;Adding ACL&#39;</span>s <span style="color:#66d9ef">for</span> path (V:\Personal\WebApi.Template\src\WebApi.Template\obj\Release\Package\PackageTmp)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;Adding declared parameter <span style="color:#e6db74">&#39;IIS Web Application Name&#39;</span>.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;Adding declared parameter <span style="color:#e6db74">&#39;NHibernate Connection string&#39;</span>.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;Adding declared parameter <span style="color:#e6db74">&#39;LOGENTRIES_TOKEN&#39;</span>.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;Package <span style="color:#e6db74">&#34;WebApi.Template.zip&#34;</span> is successfully created as single file at the following location<span style="color:#960050;background-color:#1e0010">:</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;file<span style="color:#960050;background-color:#1e0010">:</span>///V:/Personal/WebApi.Template/src/dist
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;To get the instructions on how to deploy the web package please visit the following link<span style="color:#960050;background-color:#1e0010">:</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;http<span style="color:#960050;background-color:#1e0010">:</span>//go.microsoft.com/fwlink/<span style="color:#66d9ef">?</span>LinkId=<span style="color:#ae81ff">124618</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;Sample script <span style="color:#66d9ef">for</span> deploying this package is generated at the following location<span style="color:#960050;background-color:#1e0010">:</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;V:\Personal\WebApi.Template\src\dist\WebApi.Template.deploy.cmd
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;<span style="color:#66d9ef">For</span> this sample script, you can change the deploy parameters by changing the following file<span style="color:#960050;background-color:#1e0010">:</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;V:\Personal\WebApi.Template\src\dist\WebApi.Template.SetParameters.xml
</span></span><span style="display:flex;"><span>========== Build<span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">1</span> succeeded, <span style="color:#ae81ff">0</span> failed, <span style="color:#ae81ff">0</span> up-to-date, <span style="color:#ae81ff">0</span> skipped ==========
</span></span><span style="display:flex;"><span>========== Publish<span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">1</span> succeeded, <span style="color:#ae81ff">0</span> failed, <span style="color:#ae81ff">0</span> skipped ==========
</span></span></code></pre></div><p>You will see the following lines in the output pertaining to our new parameters file:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;Adding declared parameter <span style="color:#e6db74">&#39;IIS Web Application Name&#39;</span>.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;Adding declared parameter <span style="color:#e6db74">&#39;NHibernate Connection string&#39;</span>.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>&gt;Adding declared parameter <span style="color:#e6db74">&#39;LOGENTRIES_TOKEN&#39;</span>.
</span></span></code></pre></div><p>When you open up the zip, you will see the following:</p>
<p><img src="./images/web_api_artifacts.png" alt="Published project"></p>
<p>Inside the <code>SetParameters.xml</code> you will see the following values:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;parameters&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;setParameter</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;IIS Web Application Name&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;Default Web Site/WebApi.Template&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;setParameter</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;NHibernate Connection string&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;setParameter</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;LOGENTRIES_TOKEN&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/parameters&gt;</span>
</span></span></code></pre></div><h2 id="changing-the-publish-folder-structure">Changing the publish folder structure</h2>
<p>By default, the location inside the zip file is fairly insane, here is what it would be for the project created above:
<code>WebApi.Template.zip\Content\V_C\Personal\WebApi.Template\src\WebApi.Template\obj\Release\Package\PackageTmp</code> for the project that is stored in <code>V:\Personal\WebApi.Template\src</code>. To address this, add the following to the end of your project file (I&rsquo;ve included the default commented out before/after build targets help find the position):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>  <span style="color:#75715e">&lt;!-- To modify your build process, add your task inside one of the targets below and uncomment it.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       Other similar extension points exist, see Microsoft.Common.targets.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  &lt;Target Name=&#34;BeforeBuild&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  &lt;/Target&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  &lt;Target Name=&#34;AfterBuild&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  &lt;/Target&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;PropertyGroup&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;PackagePath</span> <span style="color:#a6e22e">Condition=</span><span style="color:#e6db74">&#34; &#39;$(PackagePath)&#39;==&#39;&#39; &#34;</span><span style="color:#f92672">&gt;</span>Website<span style="color:#f92672">&lt;/PackagePath&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;EnableAddReplaceToUpdatePackagePath</span> <span style="color:#a6e22e">Condition=</span><span style="color:#e6db74">&#34; &#39;$(EnableAddReplaceToUpdatePackagePath)&#39;==&#39;&#39; &#34;</span><span style="color:#f92672">&gt;</span>true<span style="color:#f92672">&lt;/EnableAddReplaceToUpdatePackagePath&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;PackageDependsOn&gt;</span>
</span></span><span style="display:flex;"><span>    $(PackageDependsOn);
</span></span><span style="display:flex;"><span>    AddReplaceRuleForAppPath;
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/PackageDependsOn&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/PropertyGroup&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;Target</span> <span style="color:#a6e22e">Name=</span><span style="color:#e6db74">&#34;AddReplaceRuleForAppPath&#34;</span> <span style="color:#a6e22e">Condition=</span><span style="color:#e6db74">&#34; &#39;$(EnableAddReplaceToUpdatePackagePath)&#39;==&#39;true&#39; &#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;PropertyGroup&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;_PkgPathFull&gt;</span>$([System.IO.Path]::GetFullPath($(WPPAllFilesInSingleFolder)))<span style="color:#f92672">&lt;/_PkgPathFull&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/PropertyGroup&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">&lt;!-- escape the text into a regex --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;EscapeTextForRegularExpressions</span> <span style="color:#a6e22e">Text=</span><span style="color:#e6db74">&#34;$(_PkgPathFull)&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;Output</span> <span style="color:#a6e22e">TaskParameter=</span><span style="color:#e6db74">&#34;Result&#34;</span> <span style="color:#a6e22e">PropertyName=</span><span style="color:#e6db74">&#34;_PkgPathRegex&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/EscapeTextForRegularExpressions&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">&lt;!-- add the replace rule to update the path --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;ItemGroup&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;MsDeployReplaceRules</span> <span style="color:#a6e22e">Include=</span><span style="color:#e6db74">&#34;replaceFullPath&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Match&gt;</span>$(_PkgPathRegex)<span style="color:#f92672">&lt;/Match&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Replace&gt;</span>$(PackagePath)<span style="color:#f92672">&lt;/Replace&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;/MsDeployReplaceRules&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/ItemGroup&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/Target&gt;</span>
</span></span></code></pre></div><p>Now when we publish, the directory structure inside the archive will be: <code>WebApi.Template.zip\Content\Website</code>. This ties in the value specified in <code>parameters.xml</code> for the <code>scope</code> element.</p>
<h2 id="xml-matching-in-webconfig">XML Matching in Web.config</h2>
<p>Earlier in this post, there was an element in the <code>parameters.xml</code> file called <code>match</code> with the following 2 values:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>match<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/configuration/connectionStrings/add[@name=&#39;NHibernateConnection&#39;]/@connectionString&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>match<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/configuration/appSettings/add[@key=&#39;LOGENTRIES_TOKEN&#39;]/@value&#34;</span> /&gt;
</span></span></code></pre></div><p>This is used to lookup values in the <code>web.config</code> with a structure like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;connectionStrings&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;add</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;NHibernateConnection&#34;</span> <span style="color:#a6e22e">connectionString=</span><span style="color:#e6db74">&#34;Data Source=localhost;Initial Catalog=WebApiTemplate;Integrated Security=True&#34;</span> <span style="color:#a6e22e">providerName=</span><span style="color:#e6db74">&#34;System.Data.SqlClient&#34;</span> <span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/connectionStrings&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;appSettings&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;add</span> <span style="color:#a6e22e">key=</span><span style="color:#e6db74">&#34;LOGENTRIES_TOKEN&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;123456&#34;</span> <span style="color:#f92672">/&gt;</span>    
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;add</span> <span style="color:#a6e22e">key=</span><span style="color:#e6db74">&#34;SomeRandomValue&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;123456&#34;</span> <span style="color:#f92672">/&gt;</span>    
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/appSettings&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;customValues&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;value</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;MyField&#34;</span><span style="color:#f92672">&gt;</span>value<span style="color:#f92672">&lt;/value&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/customValues&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/configuration&gt;</span>
</span></span></code></pre></div><p>You can see that the nesting of the xml matches the string in the <code>match</code> element. If you need to choose between multiple elements on a specific node, the <code>&lt;element name&gt;[@&lt;identifying field&gt;='string to match']</code> will allow you to do so. I.e. for the <code>LOGENTRIES_TOKEN</code> node, unless you specify this, you will not be able to distinguish between it and <code>SomeRandomValue</code>. To set a value between the xml tags, i.e. <code>&lt;myField&gt;value&lt;/myField&gt;</code>, you would use the matching string of <code>match=&quot;/configuration/customValues/value[@name='MyField']/text()&quot;</code>.</p>
<p>In later posts, I will be showing how to incorporate this into your <a href="https://github.com/psake/psake" target="_blank">PSake</a> build script, here is what it will resemble:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>msbuild /t:Package /v:q /p:VisualStudioVersion=<span style="color:#ae81ff">12.0</span> /p:Configuration=Release /p:PackageLocation=..\dist\WebApi.Template.zip /p:ProjectParametersXMLFile=src\WebApi.Template\parameters.xml /p:DeployIisAppPath=dist src\WebApi.Template\WebApi.Template.csproj
</span></span></code></pre></div><h2 id="lastly">Lastly</h2>
<p>We now have the ability to build and package our project without including any configuration required to run it. When it is time to deploy the api, you can set values in the <code>SetParameters.xml</code> file according to your environment and use <a href="http://www.iis.net/downloads/microsoft/web-deploy" target="_blank">MSDeploy</a> to deploy. At the moment, you might be thinking <em>that is a lot of effort for something that still requires manual intervention</em>. Stay tuned, in the next post, I will show you how to create a build script using PSake that will build on top of this and the following post how we start automating deployments using this mechanism.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->

  
  <hr>
<div class="footer">
    
	    
            <a class="previous-post" href="//localhost:1313/posts/2015-12-16/ntp-on-aws/?ref=footer"><span style="font-weight:bold;">« Previous</span><br>NTP on AWS</a>
        
	    
            <div class="next-post">
                <a href="//localhost:1313/posts/2016-02-18/upgrading-berks-dependency-issue/?ref=footer"><span style="font-weight:bold;">Next »</span><br>Upgrading a Chef cookbook with Berkshelf</a>
            </div>
        
    
</div>

  
    <div class="comments">
    
        <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "cobusio" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
</div>

  
</div>
            </main>
            
  
    <div class="article-toc ">
    <div class="toc-wrapper">
      <h4 id="contents"></h4>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#creating-a-project-to-test-this">Creating a project to test this</a></li>
    <li><a href="#adding-the-parametersxml-file">Adding the parameters.xml file</a></li>
    <li><a href="#creating-a-publishing-profile">Creating a publishing profile</a></li>
    <li><a href="#changing-the-publish-folder-structure">Changing the publish folder structure</a></li>
    <li><a href="#xml-matching-in-webconfig">XML Matching in Web.config</a></li>
    <li><a href="#lastly">Lastly</a></li>
  </ul>
</nav>
    </div>
</div>

  

        </div>
    </body>
</html>
